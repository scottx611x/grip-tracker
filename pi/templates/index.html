<!doctype html>
<html lang="en"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Grip Furnace</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--bg1:#0d0d11;--bg2:#1d1d24;font-family:Inter,system-ui,sans-serif}
*{box-sizing:border-box;margin:0;padding:0}
body{
  min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:linear-gradient(145deg,var(--bg1),var(--bg2));color:#fff;overflow:hidden}
.card{
  backdrop-filter:blur(6px);background:#0007;padding:1.4rem 2.1rem;
  border-radius:14px;border:1px solid #ffffff22;width:90vw;max-width:20rem;text-align:center;z-index:10}
.card--wide{max-width:none;width:100%;padding:0;background:transparent;border:1px solid #ffffff22}
h1{font-size:1.8rem;font-weight:700;margin-bottom:.3rem}
.value{font-size:2.6rem;font-weight:700;margin:.35rem 0}
form{margin-top:1.1rem;display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}
input,select{padding:.45rem .7rem;border-radius:6px;border:1px solid #666;background:#1e1e20;color:#fff}
button{background:#f80;border:none;border-radius:6px;padding:.5rem 1rem;font-weight:700;cursor:pointer;color:#000}
#fireCanvas{position:fixed;z-index:-1;left:0;top:0;width:100vw;height:100vh;image-rendering:pixelated;pointer-events:none;opacity:.9}
.toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);background:#16a34a;color:#fff;padding:.6rem 1rem;border-radius:8px;border:1px solid #ffffff33;box-shadow:0 6px 24px #0007;opacity:0;transition:opacity .25s ease,transform .25s ease;z-index:9999;font-weight:700}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.toast.error{background:#dc2626}
.layout{display:grid;gap:1rem;align-items:start;width:95vw;max-width:1400px;margin:1rem auto}
@media(min-width:900px){.layout{grid-template-columns:minmax(260px,360px) 1fr}}
body{justify-content:flex-start;padding:1.5rem 0;gap:1rem}
.dashboard-hidden .dashboard-body{display:none}
.header-actions{display:flex;align-items:center;gap:.5rem}
.icon-btn{background:#222;border:1px solid #ffffff33;color:#fff;border-radius:6px;padding:.4rem .6rem;font-weight:700;cursor:pointer}
.icon-btn[aria-pressed="true"]{background:#444}
.dash-header{display:flex;align-items:center;justify-content:space-between;padding:0.75rem 1rem;border-bottom:1px solid #ffffff22}
.dash-header h2{font-size:1rem;margin:0;opacity:.85}
.dashboard-body{position:relative;width:100%;background:#0f1115}
.dashboard-body{height:clamp(360px,75vh,900px)}
@media(min-width:1200px){.dashboard-body{height:clamp(420px,78vh,1000px)}}
.dashboard-body{position:relative;width:100%;background:#0f1115;aspect-ratio:16/9}
@media(min-height:800px){.dashboard-body{min-height:60vh}}

</style>
</head><body>
<canvas id="fireCanvas"></canvas>
<div class="layout">
  <div class="card">
    <h1 id=user>{{ user }} ({{ side|capitalize }})</h1>
    <div>Grip&nbsp;force</div><div class=value id=grip>0.00&nbsp;lbs</div>
    <div>Session&nbsp;max</div><div class=value id=max>0.00&nbsp;lbs</div>
    <form id="metaForm" autocomplete="off">
      <input id="nameInput" name="name" value="{{ user }}" placeholder="Your name">
      <select id="sideSelect" name="side">
        <option value="right" {% if side=='right' %}selected{% endif %}>Right</option>
        <option value="left"  {% if side=='left'  %}selected{% endif %}>Left</option>
      </select>
      <button id="saveBtn" type="button">Save&nbsp;Max</button>
      <button id="resetBtn" type="button" style="background:#444;color:#fff">Clear</button>
    </form>
  </div>

  <section id="dashboardSection" class="card card--wide" style="margin:0;width:100%;padding:0;overflow:hidden">
    <div class="dash-header">
      <h2>Dashboard</h2>
      <button id="toggleDashboard" class="icon-btn" type="button" aria-pressed="false" title="Show/Hide Dashboard">Hide</button>
    </div>
    <div class="dashboard-body">
      <iframe id="grafanaFrame"
              src="http://gripper.local:3000/d/6a5a83f2-21ac-4688-8186-2a1369683943/grip-it-and-rip-it?kiosk&theme=dark"
              title="Grip Metrics"
              loading="lazy"
              referrerpolicy="no-referrer"
              allowfullscreen
              style="position:absolute;inset:0;border:0;width:100%;height:100%">
      </iframe>
    </div>
  </section>
</div>
<script src="{{ url_for('static', filename='app.js') }}" defer></script>
</body></html>
